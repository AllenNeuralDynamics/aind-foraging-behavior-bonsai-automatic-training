{
    "task": "Coupled Baiting",
    "curriculum_version": "0.1",
    "task_schema_version": "1.0",
    "parameters": {
        "Stage 1": {
            "task_schema_version": "1.0",
            "curriculum_version": "0.1",
            "task": "Coupled Baiting",
            "training_stage": "Stage 1",
            "description": "Phase B in Han's slides (block = [10, 20, 5], p_sum = 0.8, p_ratio = [1:0])",
            "BaseRewardSum": 0.8,
            "RewardFamily": 3,
            "RewardParisN": 1,
            "UncoupledReward": "",
            "BlockMin": 10,
            "BlockMax": 20,
            "BlockBeta": 5,
            "BlockMinReward": 0,
            "DelayMin": 0.5,
            "DelayMax": 0.5,
            "DelayBeta": 0.0,
            "AutoReward": true,
            "AutoWaterType": "Natural",
            "Multiplier": 0.5,
            "Unrewarded": 5,
            "Ignored": 5,
            "ITIMin": 1.0,
            "ITIMax": 7.0,
            "ITIBeta": 3.0,
            "ITIIncrease": 0.0,
            "ResponseTime": 5.0,
            "RewardConsumeTime": 3.0,
            "StopIgnores": 20000,
            "AdvancedBlockAuto": "now",
            "SwitchThr": 0.5,
            "PointsInARow": 5,
            "MaxTrial": 1000,
            "MaxTime": 90,
            "RightValue": 0.05,
            "LeftValue": 0.05,
            "RightValue_volume": 5.0,
            "LeftValue_volume": 5.0,
            "NextBlock": false,
            "GiveLeft": false,
            "GiveRight": false,
            "GiveWaterL": 0.03,
            "GiveWaterR": 0.03,
            "GiveWaterL_volume": 3.0,
            "GiveWaterR_volume": 3.0,
            "IncludeAutoReward": false,
            "SaveTraining": true,
            "InitiallyInactiveN": 2,
            "Randomness": "Exponential",
            "qt_spinbox_lineedit": 5.0
        },
        "Stage 2": {
            "task_schema_version": "1.0",
            "curriculum_version": "0.1",
            "task": "Coupled Baiting",
            "training_stage": "Stage 2",
            "description": "Phase C in Han's slides (block = [10, 40, 10], p_sum = 0.6, p_ratio = [8:1])",
            "BaseRewardSum": 0.6,
            "RewardFamily": 1,
            "RewardParisN": 1,
            "UncoupledReward": "",
            "BlockMin": 10,
            "BlockMax": 40,
            "BlockBeta": 10,
            "BlockMinReward": 0,
            "DelayMin": 1.0,
            "DelayMax": 1.0,
            "DelayBeta": 0.0,
            "AutoReward": true,
            "AutoWaterType": "Natural",
            "Multiplier": 0.5,
            "Unrewarded": 10,
            "Ignored": 10,
            "ITIMin": 2,
            "ITIMax": 10,
            "ITIBeta": 5,
            "ITIIncrease": 0.0,
            "ResponseTime": 3,
            "RewardConsumeTime": 3.0,
            "StopIgnores": 50,
            "AdvancedBlockAuto": "now",
            "SwitchThr": 0.6,
            "PointsInARow": 5,
            "MaxTrial": 1000,
            "MaxTime": 90,
            "RightValue": 0.05,
            "LeftValue": 0.05,
            "RightValue_volume": 5.0,
            "LeftValue_volume": 5.0,
            "NextBlock": false,
            "GiveLeft": false,
            "GiveRight": false,
            "GiveWaterL": 0.03,
            "GiveWaterR": 0.03,
            "GiveWaterL_volume": 3.0,
            "GiveWaterR_volume": 3.0,
            "IncludeAutoReward": false,
            "SaveTraining": true,
            "InitiallyInactiveN": 2,
            "Randomness": "Exponential",
            "qt_spinbox_lineedit": 5.0
        },
        "Stage 3": {
            "task_schema_version": "1.0",
            "curriculum_version": "0.1",
            "task": "Coupled Baiting",
            "training_stage": "Stage 3",
            "description": "Phase D in Han's slides (block = [10, 40, 10], p_sum = 0.45, p_ratio = [8:1])",
            "BaseRewardSum": 0.45,
            "RewardFamily": 1,
            "RewardParisN": 1,
            "UncoupledReward": "",
            "BlockMin": 20,
            "BlockMax": 60,
            "BlockBeta": 20,
            "BlockMinReward": 0,
            "DelayMin": 1.5,
            "DelayMax": 1.5,
            "DelayBeta": 0.0,
            "AutoReward": true,
            "AutoWaterType": "Natural",
            "Multiplier": 0.5,
            "Unrewarded": 10,
            "Ignored": 10,
            "ITIMin": 3,
            "ITIMax": 15,
            "ITIBeta": 5,
            "ITIIncrease": 0.0,
            "ResponseTime": 2,
            "RewardConsumeTime": 3.0,
            "StopIgnores": 50,
            "AdvancedBlockAuto": "now",
            "SwitchThr": 0.6,
            "PointsInARow": 5,
            "MaxTrial": 1000,
            "MaxTime": 90,
            "RightValue": 0.05,
            "LeftValue": 0.05,
            "RightValue_volume": 5.0,
            "LeftValue_volume": 5.0,
            "NextBlock": false,
            "GiveLeft": false,
            "GiveRight": false,
            "GiveWaterL": 0.03,
            "GiveWaterR": 0.03,
            "GiveWaterL_volume": 3.0,
            "GiveWaterR_volume": 3.0,
            "IncludeAutoReward": false,
            "SaveTraining": true,
            "InitiallyInactiveN": 2,
            "Randomness": "Exponential",
            "qt_spinbox_lineedit": 5.0
        },
        "Stage final": {
            "task_schema_version": "1.0",
            "curriculum_version": "0.1",
            "task": "Coupled Baiting",
            "training_stage": "Stage final",
            "description": "Phase E in Han's slides (full task: block = [20, 60, 20], p_sum = 0.45, p_ratio = [8:1], [6:1], [3:1], [1:1])",
            "BaseRewardSum": 0.45,
            "RewardFamily": 1,
            "RewardParisN": 4,
            "UncoupledReward": "",
            "BlockMin": 20,
            "BlockMax": 60,
            "BlockBeta": 20,
            "BlockMinReward": 0,
            "DelayMin": 2.0,
            "DelayMax": 2.0,
            "DelayBeta": 0,
            "AutoReward": false,
            "AutoWaterType": "Natural",
            "Multiplier": 0.5,
            "Unrewarded": 10,
            "Ignored": 10,
            "ITIMin": 3,
            "ITIMax": 30,
            "ITIBeta": 5,
            "ITIIncrease": 0.0,
            "ResponseTime": 2,
            "RewardConsumeTime": 3,
            "StopIgnores": 50,
            "AdvancedBlockAuto": "off",
            "SwitchThr": 0.6,
            "PointsInARow": 5,
            "MaxTrial": 1000,
            "MaxTime": 90,
            "RightValue": 0.05,
            "LeftValue": 0.05,
            "RightValue_volume": 5.0,
            "LeftValue_volume": 5.0,
            "NextBlock": false,
            "GiveLeft": false,
            "GiveRight": false,
            "GiveWaterL": 0.03,
            "GiveWaterR": 0.03,
            "GiveWaterL_volume": 3.0,
            "GiveWaterR_volume": 3.0,
            "IncludeAutoReward": false,
            "SaveTraining": true,
            "InitiallyInactiveN": 2,
            "Randomness": "Exponential",
            "qt_spinbox_lineedit": 5.0
        }
    },
    "curriculum": {
        "Stage 1": {
            "from_stage": "Stage 1",
            "transition_rules": [
                {
                    "decision": "progress",
                    "to_stage": "Stage 2",
                    "condition": "lambda metrics:\n                        metrics.finished_trials[-1] >= 200\n                        and\n                        metrics.foraging_efficiency[-1] >= 0.6\n                        ",
                    "condition_description": "Finished trials >= 200 and efficiency >= 0.6"
                }
            ]
        },
        "Stage 2": {
            "from_stage": "Stage 2",
            "transition_rules": [
                {
                    "decision": "progress",
                    "to_stage": "Stage 3",
                    "condition": "lambda metrics:\n                        metrics.finished_trials[-1] >= 300\n                        and\n                        metrics.foraging_efficiency[-1] >= 0.65\n                        ",
                    "condition_description": "Finished trials >= 300 and efficiency > 0.65"
                },
                {
                    "decision": "rollback",
                    "to_stage": "Stage 1",
                    "condition": "lambda metrics:\n                        metrics.finished_trials[-1] < 200\n                        or\n                        metrics.foraging_efficiency[-1] < 0.55\n                        ",
                    "condition_description": "Finished trials < 200 or efficiency < 0.55"
                }
            ]
        },
        "Stage 3": {
            "from_stage": "Stage 3",
            "transition_rules": [
                {
                    "decision": "progress",
                    "to_stage": "Stage final",
                    "condition": "lambda metrics:\n                        metrics.finished_trials[-1] >= 400\n                        and\n                        metrics.foraging_efficiency[-1] >= 0.7\n                        ",
                    "condition_description": "Finished trials >= 400 and efficiency >= 0.7"
                },
                {
                    "decision": "rollback",
                    "to_stage": "Stage 2",
                    "condition": "lambda metrics:\n                        metrics.finished_trials[-1] < 200\n                        or\n                        metrics.foraging_efficiency[-1] < 0.6\n                        ",
                    "condition_description": "Finished trials < 200 or efficiency < 0.6"
                }
            ]
        },
        "Stage final": {
            "from_stage": "Stage final",
            "transition_rules": [
                {
                    "decision": "progress",
                    "to_stage": "Graduated",
                    "condition": "lambda metrics:\n                        metrics.session_total >= 10 \n                        and\n                        metrics.session_at_current_stage >= 5\n                        and\n                        np.mean(metrics.finished_trials[-5:]) >= 500\n                        and\n                        np.mean(metrics.foraging_efficiency[-5:]) >= 0.7\n                        ",
                    "condition_description": "For recent 5 sessions,mean finished trials >= 500 and mean efficiency >= 0.7 and total sessions >= 10 and sessions at final >= 5"
                },
                {
                    "decision": "rollback",
                    "to_stage": "Stage 3",
                    "condition": "lambda metrics:\n                        np.mean(metrics.finished_trials[-2:]) < 400\n                        or\n                        np.mean(metrics.foraging_efficiency[-2:]) < 0.6\n                        ",
                    "condition_description": "For recent 2 sessions, mean finished trials < 400 or efficiency < 0.6"
                }
            ]
        }
    }
}